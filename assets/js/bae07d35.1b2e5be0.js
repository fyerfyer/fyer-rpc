"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[630],{837:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>s,contentTitle:()=>a,default:()=>p,frontMatter:()=>i,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"api-reference/rpc-package","title":"rpc Package","description":"rpc\u5305\u5b9e\u73b0\u4e86 RPC \u901a\u4fe1\u7684\u6838\u5fc3\u903b\u8f91\uff0c\u5305\u62ec\u6d88\u606f\u5e8f\u5217\u5316\u3001\u8fde\u63a5\u7ba1\u7406\u548c\u670d\u52a1\u6ce8\u518c\u7b49\u3002","source":"@site/docs/api-reference/rpc-package.md","sourceDirName":"api-reference","slug":"/api-reference/rpc-package","permalink":"/fyer-rpc/docs/api-reference/rpc-package","draft":false,"unlisted":false,"editUrl":"https://github.com/fyerfyer/fyer-rpc/tree/main/docs/api-reference/rpc-package.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"registry Package","permalink":"/fyer-rpc/docs/api-reference/registry-package"},"next":{"title":"utils Package","permalink":"/fyer-rpc/docs/api-reference/utils-package"}}');var c=r(4848),o=r(8453);const i={},a="rpc Package",s={},l=[{value:"Server",id:"server",level:3},{value:"Client",id:"client",level:3},{value:"Connection",id:"connection",level:3},{value:"ConnPool",id:"connpool",level:3},{value:"Proxy",id:"proxy",level:3}];function d(e){const n={code:"code",h1:"h1",h3:"h3",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsxs)(n.h1,{id:"rpc-package",children:[(0,c.jsx)(n.code,{children:"rpc"})," Package"]})}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"rpc"}),"\u5305\u5b9e\u73b0\u4e86 RPC \u901a\u4fe1\u7684\u6838\u5fc3\u903b\u8f91\uff0c\u5305\u62ec\u6d88\u606f\u5e8f\u5217\u5316\u3001\u8fde\u63a5\u7ba1\u7406\u548c\u670d\u52a1\u6ce8\u518c\u7b49\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"server",children:"Server"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"Server"}),"\u7ed3\u6784\u4f53\u5b9e\u73b0\u4e86 RPC \u670d\u52a1\u5668\uff1a"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-go",children:"type Server struct {\r\n    services          map[string]*ServiceDesc\r\n    serializationType uint8\r\n}\r\n\r\n// NewServer \u521b\u5efa\u65b0\u7684RPC\u670d\u52a1\u5668\r\nfunc NewServer() *Server\r\n\r\n// RegisterService \u6ce8\u518c\u670d\u52a1\u5b9e\u4f8b\r\nfunc (s *Server) RegisterService(service interface{}) error\r\n\r\n// Start \u542f\u52a8\u670d\u52a1\u5668\r\nfunc (s *Server) Start(address string) error\n"})}),"\n",(0,c.jsx)(n.h3,{id:"client",children:"Client"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"Client"}),"\u7ed3\u6784\u4f53\u5b9e\u73b0\u4e86 RPC \u5ba2\u6237\u7aef\uff1a"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-go",children:"type Client struct {\r\n    conn            *Connection\r\n    messageID       uint64\r\n    failoverConfig  *failover.Config\r\n    failoverHandler *failover.DefaultFailoverHandler\r\n    enableFailover  bool\r\n}\r\n\r\n// NewClient \u521b\u5efa\u65b0\u7684RPC\u5ba2\u6237\u7aef\r\nfunc NewClient(address string, options ...ClientOption) (*Client, error)\r\n\r\n// Call \u8c03\u7528\u8fdc\u7a0b\u670d\u52a1\r\nfunc (c *Client) Call(serviceName, methodName string, args interface{}) ([]byte, error)\r\n\r\n// CallWithTimeout \u5e26\u8d85\u65f6\u7684RPC\u8c03\u7528\r\nfunc (c *Client) CallWithTimeout(ctx context.Context, serviceName, methodName string, args interface{}) ([]byte, error)\n"})}),"\n",(0,c.jsx)(n.h3,{id:"connection",children:"Connection"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"Connection"}),"\u7ed3\u6784\u4f53\u5c01\u88c5\u4e86\u5e95\u5c42\u7f51\u7edc\u8fde\u63a5\uff0c\u63d0\u4f9b\u534f\u8bae\u5c42\u9762\u7684\u8bfb\u5199\uff1a"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-go",children:"type Connection struct {\r\n    conn     net.Conn\r\n    protocol protocol.Protocol\r\n}\r\n\r\n// Write \u53d1\u9001\u6d88\u606f\r\nfunc (c *Connection) Write(serviceName, methodName string, messageType uint8, serializationType uint8, messageID uint64, metadata *protocol.Metadata, payload []byte) error\r\n\r\n// Read \u63a5\u6536\u6d88\u606f\r\nfunc (c *Connection) Read() (*protocol.Message, error)\n"})}),"\n",(0,c.jsx)(n.h3,{id:"connpool",children:"ConnPool"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"ConnPool"}),"\u7ed3\u6784\u4f53\u5b9e\u73b0\u4e86\u8fde\u63a5\u6c60\uff0c\u7528\u4e8e\u7ba1\u7406\u548c\u590d\u7528\u5ba2\u6237\u7aef\u8fde\u63a5\uff1a"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-go",children:"type ConnPool struct {\r\n    address     string\r\n    maxIdle     int\r\n    idleTimeout time.Duration\r\n    conns       chan *Client\r\n}\r\n\r\n// NewConnPool \u521b\u5efa\u8fde\u63a5\u6c60\r\nfunc NewConnPool(address string, maxIdle int, idleTimeout time.Duration) *ConnPool\r\n\r\n// Get \u83b7\u53d6\u8fde\u63a5\r\nfunc (p *ConnPool) Get() (*Client, error)\r\n\r\n// Put \u5f52\u8fd8\u8fde\u63a5\r\nfunc (p *ConnPool) Put(client *Client)\n"})}),"\n",(0,c.jsx)(n.h3,{id:"proxy",children:"Proxy"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"Proxy"}),"\u7ed3\u6784\u4f53\u5b9e\u73b0\u4e86\u670d\u52a1\u4ee3\u7406\uff0c\u7528\u4e8e\u521b\u5efa\u5ba2\u6237\u7aef\u4ee3\u7406\u5bf9\u8c61\uff1a"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-go",children:"// InitProxy \u521d\u59cb\u5316\u670d\u52a1\u4ee3\u7406\r\nfunc InitProxy(address string, target interface{}, opts ...ProxyOption) error\n"})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>a});var t=r(6540);const c={},o=t.createContext(c);function i(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:i(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);