# `rpc`目录概述

### 1.概览

`rpc`目录是fyer-rpc框架的核心部分，它为分布式系统之间面向服务的通信提供了完整的rpc实现。该目录包含了rpc服务端和客户端组件、连接管理、服务发现、故障转移机制以及动态代理生成等功能。

### 2.目录结构

`rpc`目录的目录结构如下：
```plaintext
rpc/
├── client.go        # rpc客户端实现
├── connection.go    # 网络连接抽象
├── pool.go          # 客户端连接的连接池
├── proxy.go         # rpc服务的动态代理生成
├── server.go        # rpc服务端实现
└── type.go          # 核心数据类型与接口定义
```

### 3.核心功能

`rpc`目录实现了如下的功能：

* **服务注册与发现**：在服务器上注册服务实现，并通过名称定位服务
* **请求/响应处理**：对 RPC 请求和响应进行编码/解码
* **连接管理**：建立并维护客户端与服务器之间的网络连接
* **连接池**：复用客户端连接以提升性能
* **动态代理**：为服务接口生成客户端代理
* **故障转移机制**：处理故障并在不同服务器上重试操作
* **负载均衡**：将请求分配到多个服务器实例上

### 4.架构设计

#### 组件交互

该框架的组件交互方式如下：

* 服务端：
  * 服务器注册服务实现
  * 当连接到达时，服务器将请求分发到对应的服务方法
  * 连接组件负责协议层的消息编码/解码
  
* 客户端：
  * 客户端建立与服务器的连接并发起 RPC 调用
  * `ConnPool`负责管理可复用的客户端连接池
  * 代理组件生成动态代理，将方法调用转换为 RPC 请求
